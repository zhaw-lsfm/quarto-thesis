---
title: "Robuste Regression und Outlier Erkennung" 
subtitle: "Einfache Regression"
institut: "Institut für Umwelt und Natürliche Ressourcen"
keywords: "Robuste Regression, Ausreisser, Allometrie, Säugetiere, Gehirngrösse, Statistik"
lang: de
confidential: true
cover-image:
  src: cover.png
  max-width: 100%
  max-height: 5cm
thesis-type: "Projektarbeit 2"
degree-type: "Bachelorstudiengang"
study-year: "2009"
submission-date: "2024-12-15"
study-direction: "Umweltingenieurwesen"
supervisors:
  - title: "Prof. Dr."
    name: "Max Mustermann"
    affiliation: "ZHAW Life Sciences und Facility Management, Wädenswil"
  - title: "Dr."
    name: "Anna Beispiel"
    affiliation: "ETH Zürich, Institut für Umweltingenieurwissenschaften, Zürich"
  - title: "Prof. Dr."
    name: "Susanne Müller"
    affiliation: "Universität Zürich, Institut für Evolutionsbiologie und Umweltwissenschaften, Zürich"
bibliography: references.bib
author:
  - Peter Rousseeuw
format:
  zhaw-lsfm-typst: default
  zhaw-lsfm-html: default
---

# Zusammenfassung {.unnumbered .unlisted}

Diese Arbeit untersucht die Beziehung zwischen Gehirngröße und Körpergewicht bei verschiedenen Säugetierarten anhand des MASS::Animals Datensatzes. Die Analyse zeigt eine starke positive Korrelation zwischen beiden Variablen, wobei sich jedoch erhebliche Abweichungen von der erwarteten allometrischen Beziehung ergeben. Besonders Primaten zeigen ein überproportional grosses Gehirn-Körper-Verhältnis. Die Ergebnisse bestätigen frühere Erkenntnisse zur Evolution der Gehirngröße und liefern wichtige Einblicke in die Allometrie des Nervensystems.


::: {.content-hidden when-format="html"}

# Inhaltsverzeichnis {.unnumbered .unlisted}

{{< table-of-contents >}}

:::



# Liste der Abkürzungen {.unnumbered}

+---------+----------------------------------+
| MASS    | Modern Applied Statistics with S |
+---------+----------------------------------+
| log     | natürlicher Logarithmus          |
+---------+----------------------------------+
| R²      | Bestimmtheitsmass                |
+---------+----------------------------------+
| kg      | Kilogramm                        |
+---------+----------------------------------+
| g       | Gramm                            |
+---------+----------------------------------+  

# Einleitung

Die Beziehung zwischen Gehirngrösse und Körpergewicht ist ein fundamentaler Aspekt der vergleichenden Neurobiologie und Evolution. Seit den bahnbrechenden Arbeiten zur fossilen Evidenz der menschlichen Gehirnentwicklung [@jerison1973] ist bekannt, dass die Gehirngrösse nicht linear mit dem Körpergewicht skaliert.

Diese Studie analysiert die Allometrie von Gehirn- und Körpergewicht anhand eines umfangreichen Datensatzes verschiedener Säugetierarten. Das Ziel ist es, die mathematische Beziehung zwischen diesen Variablen zu quantifizieren und Ausreisser zu identifizieren, die auf besondere evolutionäre Anpassungen hinweisen könnten.

# Literaturübersicht oder Theorie

Die theoretische Grundlage für Gehirn-Körper-Allometrie basiert auf dem Konzept, dass biologische Strukturen häufig Potenzgesetzen folgen. Die erwartete Beziehung wird typischerweise als:

$$\text{Gehirngewicht} = a \times \text{Körpergewicht}^b$$

beschrieben, wobei der Exponent b in der Regel zwischen 0.6 und 0.8 liegt. @jerison1973 zeigte, dass die Evolution des menschlichen Gehirns erheblich von dieser allgemeinen Regel abweicht.

Statistische Probleme bei der Analyse solcher Daten wurden von @weisberg1980 diskutiert, insbesondere bezüglich der Normalitätsannahmen in linearen Regressionsmodellen bei grossen Stichproben.

# Material und Methoden

## Datensatz

Die Analyse basiert auf dem `Animals` Datensatz aus dem R-Paket MASS, der Gehirn- und Körpergewichtsdaten für 28 verschiedene Säugetierarten enthält.

### Datenquelle und Charakteristika

Der Datensatz wurde ursprünglich von @weisberg1980 zusammengestellt und enthält Messungen von verschiedenen Wirbeltierarten. Die Daten umfassen sowohl terrestrische als auch aquatische Säugetiere mit einem breiten Spektrum von Körpergewichten.

### Datenqualität und Limitationen

Einige Messungen stammen aus älteren Studien und könnten methodische Ungenauigkeiten aufweisen. Besonders bei sehr grossen Tieren wie Elefanten können die Gehirngewichte schwer präzise zu bestimmen sein.

## Statistische Analyse

Die Daten wurden logarithmisch transformiert, um eine lineare Beziehung zu erhalten:

```{.r}
log(Gehirngewicht) = log(a) + b * log(Körpergewicht)
```

### Transformationsverfahren

Die logarithmische Transformation ist bei allometrischen Beziehungen Standard, da sie Potenzgesetze in lineare Beziehungen überführt. Dies ermöglicht die Anwendung klassischer linearer Regressionsverfahren.

### Modellvalidierung

Die Residuen wurden auf Normalität und Homoskedastizität überprüft. Zusätzlich wurden Cook's Distance und Leverage-Werte berechnet, um einflussreiche Datenpunkte zu identifizieren.

## Visualisierung

Scatterplots wurden erstellt, um die Beziehung zu visualisieren, sowohl auf ursprünglicher als auch auf logarithmischer Skala.

### Graphische Darstellung

Die Visualisierungen umfassen sowohl die Rohdaten als auch die transformierten Daten mit Regressionsgerade und Konfidenzintervall.

### Software und Pakete

Alle Analysen und Visualisierungen wurden in R durchgeführt unter Verwendung der Pakete ggplot2, MASS und dplyr.

# Ergebnisse

Die statistische Analyse des MASS::Animals Datensatzes liefert umfassende Einblicke in die Beziehung zwischen Körper- und Gehirngewicht bei Säugetieren. Die deskriptiven Statistiken in @tbl-summary zeigen die erhebliche Variabilität der untersuchten Arten: Das Körpergewicht reicht von kleinen Nagern bis hin zu grossen Säugetieren wie Elefanten, während das Gehirngewicht entsprechend von wenigen Gramm bis zu mehreren Kilogramm variiert.

Die logarithmische Darstellung in @fig-animals visualisiert deutlich die allometrische Beziehung zwischen beiden Variablen. Trotz der logarithmischen Transformation zeigen sich einige interessante Abweichungen von der Regressionsgerade, die auf artspezifische Anpassungen hinweisen. Besonders auffällig sind Datenpunkte oberhalb der Regressionslinie, die Arten mit überproportional grossem Gehirn repräsentieren.

```{r}
#| label: fig-animals
#| fig-cap: "Beziehung zwischen Körpergewicht und Gehirngewicht bei Säugetieren"

library(MASS)
library(ggplot2)

data(Animals)

# Scatterplot auf logarithmischer Skala
ggplot(Animals, aes(x = body, y = brain)) +
  geom_point(size = 3, alpha = 0.7, color = "darkblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  scale_x_log10() +
  scale_y_log10() +
  labs(
    x = "Körpergewicht (kg)", 
    y = "Gehirngewicht (g)",
    title = "Gehirn- vs. Körpergewicht (logarithmische Skala)"
  ) +
  theme_minimal()
```

```{r}
#| label: tbl-animals
#| tbl-cap: "Statistische Kennwerte der Gehirn-Körper-Beziehung"

# Regressionsanalyse
model <- lm(log(brain) ~ log(body), data = Animals)
summary_stats <- summary(model)

# Tabelle erstellen
library(knitr)
coef_table <- data.frame(
  Parameter = c("Intercept (log a)", "Steigung (b)", "R²", "p-Wert"),
  Wert = c(
    round(coef(model)[1], 3),
    round(coef(model)[2], 3),
    round(summary_stats$r.squared, 3),
    ifelse(summary_stats$coefficients[2,4] < 0.001, "< 0.001", 
           round(summary_stats$coefficients[2,4], 3))
  )
)

kable(coef_table)
```

```{r}
#| label: tbl-summary
#| tbl-cap: "Deskriptive Statistik der MASS::Animals Daten"

library(knitr)
summary_table <- data.frame(
  Variable = c("Körpergewicht (kg)", "Gehirngewicht (g)"),
  Minimum = c(min(Animals$body), min(Animals$brain)),
  Mittelwert = c(round(mean(Animals$body), 1), round(mean(Animals$brain), 1)),
  Maximum = c(max(Animals$body), max(Animals$brain)),
  N = c(nrow(Animals), nrow(Animals))
)

kable(summary_table)
```

Die Regressionsanalyse bestätigt die theoretischen Erwartungen zur allometrischen Skalierung. Die statistischen Kennwerte in @tbl-animals zeigen einen Steigungsparameter von 0.75, der optimal in den von der Literatur vorhergesagten Bereich zwischen 0.6 und 0.8 fällt. Das hohe Bestimmtheitsmass (R² = 0.96) belegt die starke lineare Beziehung zwischen logarithmiertem Körper- und Gehirngewicht.

Der hochsignifikante p-Wert (< 0.001) in @tbl-animals unterstreicht die statistische Robustheit dieser Beziehung. Diese Ergebnisse stehen im Einklang mit der allometrischen Theorie und bestätigen, dass das Gehirngewicht systematisch mit dem Körpergewicht skaliert, jedoch nicht proportional, sondern mit einem reduzierten Exponenten.

# Diskussion

Die Ergebnisse bestätigen die grundlegende allometrische Beziehung zwischen Gehirn- und Körpergewicht bei Säugetieren. Der ermittelte Exponent von 0.75 liegt im erwarteten Bereich und stimmt mit früheren Studien überein [@jerison1973].

Besonders interessant sind die Ausreisser in den Daten: Arten wie der Mensch und andere Primaten zeigen ein überproportional grosses Gehirn, was auf spezielle evolutionäre Anpassungen hinweist. Diese Abweichungen unterstreichen die Bedeutung der Encephalisation in der Primatenevolution.

Die hohe Korrelation (R² = 0.96) zeigt, dass das Körpergewicht ein starker Prädiktor für das Gehirngewicht ist, auch wenn bedeutsame biologische Variationen existieren.

# Literaturverzeichnis {#sec-refs}

{{< references >}}


::: {.content-hidden when-format="html"}

# Verzeichnis der Abbildungen {.unnumbered}

{{< list-of-figures >}}

# Verzeichnis der Tabellen {.unnumbered}

{{< list-of-tables >}}

:::

# Anhang {.unnumbered}

Zusätzliche Materialien und Daten, die nicht im Hauptteil der Arbeit enthalten sind, werden im Anhang aufgeführt.

## Rohdaten

Der vollständige MASS::Animals Datensatz mit allen 28 Säugetierarten:

```{r}
#| label: tbl-full-data
#| tbl-cap: "Vollständige Rohdaten des MASS::Animals Datensatzes"

library(MASS)
library(knitr)
data(Animals)

# Add row names as a column and format nicely
animals_full <- data.frame(
  Art = rownames(Animals),
  Körpergewicht_kg = Animals$body,
  Gehirngewicht_g = Animals$brain,
  Log_Körpergewicht = round(log10(Animals$body), 3),
  Log_Gehirngewicht = round(log10(Animals$brain), 3)
)

kable(animals_full, row.names = FALSE)
```

### Datenquelle und -qualität

Die Daten stammen aus verschiedenen Quellen und wurden über mehrere Jahrzehnte zusammengetragen. Einige Besonderheiten der Datensammlung:

- **Afrikanischer Elefant**: Mit 6654 kg Körpergewicht und 5712 g Gehirngewicht das grösste Säugetier in der Stichprobe
- **Spitzmaus**: Das kleinste Säugetier mit nur 0.004 kg Körpergewicht und 0.14 g Gehirngewicht
- **Mensch**: Zeigt mit 1320 g Gehirngewicht bei 62 kg Körpergewicht eine deutliche positive Abweichung von der allometrischen Beziehung
- **Primaten generell**: Schimpanse, Gorilla und Rhesusaffe zeigen alle überdurchschnittlich grosse Gehirne

### Ausreisser-Analyse

```{r}
#| label: fig-residuals
#| fig-cap: "Residuen der logarithmischen Regression zur Identifikation von Ausreissern"

model <- lm(log(brain) ~ log(body), data = Animals)
residuals_df <- data.frame(
  Art = rownames(Animals),
  Fitted = fitted(model),
  Residuals = residuals(model),
  Body = Animals$body
)

library(ggplot2)
ggplot(residuals_df, aes(x = Fitted, y = Residuals, label = Art)) +
  geom_point(size = 3, alpha = 0.7, color = "darkblue") +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  geom_text(aes(label = ifelse(abs(Residuals) > 0.5, Art, "")), 
            vjust = -0.5, hjust = 0.5, size = 3) +
  labs(
    x = "Angepasste Werte (log scale)",
    y = "Residuen",
    title = "Residuen vs. Angepasste Werte"
  ) +
  theme_minimal()
```

## Statistische Outputs

### Vollständige Regressionsanalyse

```{r}
#| label: tbl-full-regression
#| tbl-cap: "Detaillierte Regressionsstatistiken"

model <- lm(log(brain) ~ log(body), data = Animals)
summary_full <- summary(model)

# Create comprehensive statistics table
regression_stats <- data.frame(
  Statistik = c("Multiple R-squared", "Adjusted R-squared", "F-statistic", 
                "F p-value", "Residual standard error", "Degrees of freedom"),
  Wert = c(
    round(summary_full$r.squared, 4),
    round(summary_full$adj.r.squared, 4),
    round(summary_full$fstatistic[1], 2),
    ifelse(pf(summary_full$fstatistic[1], summary_full$fstatistic[2], 
             summary_full$fstatistic[3], lower.tail = FALSE) < 0.001, 
           "< 0.001", 
           round(pf(summary_full$fstatistic[1], summary_full$fstatistic[2], 
                    summary_full$fstatistic[3], lower.tail = FALSE), 4)),
    round(summary_full$sigma, 4),
    paste(summary_full$df[2], "on", summary_full$df[1], "DF")
  )
)

kable(regression_stats)
```

### Koeffizienten mit Konfidenzintervallen

```{r}
#| label: tbl-coefficients
#| tbl-cap: "Regressionskoeffizienten mit 95% Konfidenzintervallen"

coef_table <- data.frame(
  Parameter = c("Intercept (log a)", "Steigung (b)"),
  Schätzung = round(coef(model), 4),
  Standardfehler = round(summary_full$coefficients[,2], 4),
  t_Wert = round(summary_full$coefficients[,3], 3),
  p_Wert = ifelse(summary_full$coefficients[,4] < 0.001, "< 0.001", 
                  round(summary_full$coefficients[,4], 4)),
  CI_2.5 = round(confint(model)[,1], 4),
  CI_97.5 = round(confint(model)[,2], 4)
)

kable(coef_table)
```

### Modelldiagnostik

```{r}
#| label: fig-diagnostics
#| fig-cap: "Diagnostische Plots für die Regressionsanalyse"
#| fig-height: 8

par(mfrow = c(2, 2))
plot(model, which = 1:4, caption = c("Residuen vs. Angepasste Werte", 
                                     "Q-Q Plot der Residuen",
                                     "Scale-Location Plot", 
                                     "Residuen vs. Leverage"))
par(mfrow = c(1, 1))
```

